---
title: "Influence of Party Affiliation on Reported Voting Difficulty"
author: "Kevin Lustig, Rebecca Nissan, Anuradha Passan, Giorgio Soggiu"
date: "2/29/2022"
output:
  pdf_document:
    toc: true
    number_sections: true
    toc_depth: 3
header-includes:
- \usepackage{booktabs}
---

  \newpage
\setcounter{page}{1}

```{r , include=FALSE}
knitr::opts_chunk$set(fig.width=3, fig.height=2)
```

```{r setup and load packages, include=FALSE}

options(tinytex.verbose = TRUE)
knitr::opts_chunk$set(echo=FALSE, message=FALSE)

library(tidyverse)
library(magrittr)
library(knitr)
library(ggpubr)
library(ggplot2)
```

```{r load data, include=FALSE}
source("data_wrangling.R")
```

```{r echo=FALSE}
data_fin_reduced <- data_fin %>% select(party, diff_index, diff_subj, diff_subj2)
data_fin_reduced <- data_fin_reduced %>% filter(data_fin_reduced$party == 'D' | data_fin_reduced$party == 'R')

# splitting the dataset in two 
sub_dem <- data_fin_reduced[data_fin_reduced$'party' == 'D', ]
sub_rep <- data_fin_reduced[data_fin_reduced$'party' == 'R', ]

# focus on only voters who self-reported difficulty either after casting a vote or being unable to
data_fin_difficulty = data_fin_reduced %>% filter(diff_subj2 > 1)

```

# Importance and Context

The topic of obstacles to voting has been the focus of considerable discussion in the United States in recent years, including notably before, during, and since the 2020 federal election. The debate over the facility with which Americans are able to vote has elicited claims both that voting in practice is too restrictive and challenging to allow for participation by all would-be voters and contrarily that it is so open and unrestricted that fraudulent voting can and does occur with limited recourse. Perhaps unsurprisingly, these assertions have largely arisen along partisan lines, and have been used as evidence in support of (often contradictory) changes to voting laws by elected officials and their supporters in both major political parties. Those affiliated with the Democratic Party are more likely to feel that it is too difficult to vote and support efforts to increase access to the polls, while Republican Party supporters are more likely to support restrictions on voting access. Naturally, the partisan nature of this debate means that voting behavior itself has been impacted, for example with Democratic voters significantly more likely to vote early and by mail than Republican voters in 2020, both methods widely discussed as fraught with error and likely to be fraudulent by prominent members of the Republican party. 

Naturally, this raises the question of whether the actual experience of difficulty voting is related as well to party affiliation. Perhaps attitudes toward measures to loosen or tighten voting regulations are driven by real or perceived differences in personal experience with voting difficulty. This analysis therefore attempts to examine the linkage, if any, between political party identification and difficulty voting. We seek to address the following research question: 

*Did Democrats or Republicans have more difficulty voting in the 2020 election?*

This question has the potential to illuminate important aspects of the debate on measures to change voting laws. Namely, is it possible that Democrat-associated policies to ease voting regulations are based on an actual increased level of difficulty voting for Democrats as compared to Republicans (and likewise for Republican efforts to further restrict voting?) What is the scale of the actual voting difficulty for members of each party, and who would be most affected and in what way by changes meant to address the current ease or difficulty of voting? 

# Data and Methodology

```{r plot diff_index, echo=FALSE}
# diff_index distribution for Democrats
gghistogram(sub_dem$diff_index, bins = 7, fill= 'steelblue', xlab = 'Total instances of difficulty reported', main = 'Difficulty Index: Democrats')
```
```{r echo=FALSE}
# diff_index distribution for Republicans
gghistogram(sub_rep$diff_index, bins = 5, fill= 'steelblue', xlab = 'Total instances of difficulty reported',  main = 'Difficulty Index: Republicans')
```
```{r echo=FALSE}
# diff_subj distribution for Democrats
gghistogram(sub_dem$diff_subj2, bins = 3, fill= 'steelblue', xlab = 'Had/did not have difficulty voting', main = 'Self-Reported Difficulty: Democrats')

```
```{r echo=FALSE}
# diff_subj distribution for Republicans
gghistogram(sub_dem$diff_subj2, bins = 3, fill= 'steelblue', xlab = 'Had/did not have difficulty voting', main = 'Self-Reported Difficulty: Republicans')

```
This study will use data from the 2020 American National Election Studies (ANES), specifically their 2020 Time Series Study, which includes survey responses for a representitive sample of voters from both before and after the 2020 election.  *Need to add anything more in here? like sampling/representation maybe?? pre and post voting?? also maybe something on using only post interview people? there was some filter applied no? ....Rebecca note: added another clause to try to address this*

In order to answer the research question *Did Democrats or Republicans have more difficulty voting in the 2020 election?*, three conceptualization questions need to be answered:
1. Who or what is a **voter**?
2. Who is a Republican and who is a Democrat; i.e. How do we define **party affiliation**?
3. What is **difficulty in voting**?

For this study, the below definitions and assumptions have been applied:

*Voter*
We define a "voter" as anyone in the ANES survey sample who registered to vote - regardless of whether or not they voted in the 2020 election. Since this study examines **difficulty** voting, it is important to consider the subset of people who implied some intention to vote (by registering) but ultimately did not vote - perhaps because of some difficulty. In order to determine who is a "registered" voter, we use a post-vote status variable because it is possible some people registered after the pre-election survey but before the election. Eliminating anyone for whom we did not have voter status info as well as those who were not registered by the time of the post-election survey drops 1,227 individuals from our sample, leaving 7,053 "voters."

*Party Affiliation*
In order to determine party affiliation, we use a self-reported party identification variable. Since this study focuses specifically on Democrats and Republicans (and does not break down results by the strength of one's affiliation to their party), we classify anyone who reported leaning Democrat as a Democrat and anyone who reported leaning Republican as a Republican. The 719 individuals who self-identified as Independents with no party lean are classified as Independents; they remain in our sample for exploration purposes, but the difficulty analysis focuses only on Democrats and Republicans. Another possible way to define somebody's party is based on who they voted for: but in the 2020 election especially, many people did not vote for their party's candidate. Therefore, we define party affiliation solely based on the self-reported variable. 

*Difficulty in Voting*
Given the subjective nature of the term "difficulty", there are various ways difficulty in voting could be conceptualized. The ANES dataset had variables which specifically asked those who had voted whether they had encountered specific difficulties in trying to vote (e.g. long lines, failing to provide proper registration papers, etc.) and how difficult voters found it to vote. The dataset also included variables asking how voters (who voted) voted (in person or via absentee ballot) and reasons as to why people did not vote. After much review and reflection, the researchers decided on two variables to measure difficulty in voting: 
1. **Difficulty Index:** This is a synthetic index that was created to showcase the extent of how many different types of obstacles voters faced in trying to vote. It is based off of the group of variables asking respondents who voted whether they encountered a specific type of obstacle, and the main reason a respondent did not vote.  

Of the voters who voted AND indicated facing any sort of difficulty, 79.9% (**how to source the code i did here?**) indicated facing only one difficulty, giving the notion that the majority of voters likely experienced one main difficulty. As such the researchers felt comfortable enough to make the assumption that for the respondents who did not vote, the main reason they did not vote was likely the main relevant difficulty they faced which deterred them from being able to cast their vote. This assumption allowed the research team to use the "main reason respondent did not vote" variable to account for the difficulties faced by registered voters who did not end up voting. 

In the variable outlining why respondents did not vote, most of the answer choices aligned with the options presented to those who did vote. Some types of difficulty were relevant to only those who voted or those who did not end up voting. To create the difficulty index, the research team created separate binary variables for each type of difficulty: registration issues, not having the correct form of ID, difficulties in receiving absentee ballots, confusion about the ballot or machine, difficulties in getting to the polling place (i.e. transportation issues), long wait times, difficulties with work schedules, bad weather, issues mailing ballots, being sick or disabled, not allowed to vote at the polls after trying, not knowing where to vote, and other. 

After creating the binary variables, the sum of them all was taken to create the difficulty index for each voter. There were no weights applied to this index because based on the data given in the dataset, there was no way to perceive which difficulty was worse than others - especially given that certain difficulties may have been more or less impactful for certain voters given their specific context. As such, this index is more to highlight the magnitude of the different types of difficulties voters faced. 

2. **Subjective difficulty:** Since the difficulty index is not able to account for how much difficulty each voter encountered, regardless of the difficulty type, the research team also developed a subjective difficulty variable. 

The dataset had a variable in which the levels of difficulties (such as moderate or extreme) of those who did vote in the 2020 election were recorded. No such variable was recorded for those who did not vote, but based on *ANNIE TO FINISH BASED ON WHAT IS DECIDED REGARDING WHICH SUBJECTIVE DIFFICULTY VARIABLE TO USE*


# Results

Our analysis begins with an examination of self-reported difficulty voting across all voters surveyed. We test the difference, if any, between the number of reported types of difficulty encountered by Republican- and Democrat-identified voters:

```{r echo=TRUE}
t.test(diff_index~party,alternative = "two.sided",data = data_fin_reduced )
```

The result of this test provides no evidence that there is a significant difference in reported experience of voting difficulty based on political identification (t=1.2208,p=0.2222). This is unsurprising because Democrats reported a mean experience of .2807 types of voting difficulty, while Republicans reported a mean of .2628 types That is, voters of both parties collectively experienced, on average, far less than even one incident of difficulty; in fact, `r round((1-count(data_fin_difficulty)/count(data_fin_reduced))*100,2)`% of voters self-reported no difficulty at all (Table 1). 

Importantly, the variable tested (number of types of difficulty experienced) does not accurately reflect the situation of voters who were unable to vote due to difficulty because of differences in the survey approach for these voters, as previously discussed. However, this group is of particular interest to our study as the ultimate concern with difficulty voting is that it may prevent eligible voters from casting a ballot. Therefore, we consider those voters who attempted to vote and did not due to difficulty as the *most severely* impacted by voting obstacles. 

```{r make summary table} 
party_summary_table <- data_fin_reduced %>% 
  mutate(
    party = case_when(
      party == "D" ~ 'Democrat', 
      party == "R" ~ 'Republican'), 
  difficulty = case_when(
      diff_subj2 > 1 ~ 'Reported difficulty', 
      diff_subj2 == 1 ~ 'Did not report difficulty')) %$% 
  prop.table(
    table(
      party, 
      difficulty))

voted_summary_table <- data_fin_reduced %>% 
  mutate(
    vote_status = case_when(
      diff_subj2 < 3 ~ 'Voted', 
      diff_subj2 == 3 ~ 'Didn\'t Vote'), 
    difficulty = case_when(
      diff_subj2 > 1 ~ 'Reported difficulty', 
      diff_subj2 == 1 ~ 'Did not report difficulty')) %$% 
  prop.table(
    table(
      vote_status, 
      difficulty))
```

```{r summary-table}
kable(
  party_summary_table,
  digits = 3,
  caption = 'Self-Reported Difficulty and Party', 
  booktabs = TRUE, 
  position = "float_left"
)
kable(
  voted_summary_table,
  digits = 3,
  caption = 'Self-Reported Difficulty and Voting Ability', 
  booktabs = TRUE, 
  position = "float_right"
)
```

Consequently, we further analyze an additional variable which describes registered voters ordinally based both on whether they experienced difficulty and whether they were able to cast a vote (Table 2). We then reduce this group to just those who experienced difficulty by excluding those who did not self-report difficulty (Category 1); this group represents a small subset (n=`r count(data_fin_difficulty)`) of the overall Democrat- and Republican-identified surveyed population (n=`r count(data_fin_reduced)`). Nevertheless, it allows us to focus our analysis on the distribution of voters who encountered voting difficulty and were (Category 2) or were not (Category 3) subsequently able to vote.

Using this variable, we test whether there are differences by party in the ability to complete the process of casting a vote among those who experienced difficulty:

```{r echo=TRUE}
wilcox.test(diff_subj2~party,alternative = "two.sided",data = data_fin_difficulty, conf.int=TRUE )
```

In this result, we find evidence of a difference in the distribution of voting difficulty between the two parties, with a small but significant decrease in the category value for Republican voters as compared to Democratic voters (p=0.01746). Following the principle that inability to vote due to difficulty indicates greater voting difficulty, this suggests that Democratic voters had a significantly harder time voting than Republican voters. Based on this result, we reject the null hypothesis that there is no difference in voting difficulty between the political groups.

It is important to note some key limitations of this approach. Factors that are not considered in this analysis are quite likely to have an impact on the experience of voting difficulty, such as method of voting and voting location. Further analysis that attempts to analyze differences across methods and locations would be a valuable addition to these findings. Moreover, it is critical to note that the method of questioning voters in the ANES survey asks only for self-reported and therefore subjective descriptors of difficulty. It does not attempt to validate or weight these incidents. Thus, this study does not attempt to analyze an objective measure of how difficult the voting experience was for any voter. In reality, two voters may regard the same experience as more or less difficult, and may choose to behave differently at the polls because of that perception. Different data than that found in the ANES dataset will be needed to form a clearer and less subjective picture of the nature of obstacles voters face when attempting to cast a vote. 

# Discussion

Our analysis finds, first, that the reported incidence of voting difficulty is quite low for all voters. Our analysis using the difficulty index showed no significant difference in difficulty between Republican and Democrat voters; this is likely at least in party due to the fact that neither party experienced much difficulty voting. However, in examining the subset of voters who did self-report difficulty, we propose that it is meaningful to know how many were not able to ultimately cast a ballot due to that difficulty. With regard to this measurement, we do find that Democrats who experienced difficulty at the polls were slightly but significantly more likely to be unable to vote than Republicans. 

This study suggests a number of interesting questions that merit further research. Are there significant differences in the kind or amount of difficulty faced by just those voters who did experience difficulty? Do Democrat and Republican voters report or experience different kinds of difficulty at different rates? Does the incidence of difficulty voting change from election to election? We believe our results are most interesting in the context of these and other answers in helping to form an evidence base for ongoing debates about voting access. The right mix of policy solutions for changing (or preserving) current voting practices depends on an understanding of the real ease or difficulty of voting, and particularly whether some groups find voting to be more or less accessible to them than other groups do. We hope that our findings can help to point the way toward additional answers that will contribute to effective and evidence-based policy-making that ensures fair access to the polls for all voters with a minimum of obstacles. 



### Working code

```{r echo=FALSE}
# splitting the dataset in two 
sub_dem <- data_fin[data_fin$'party' == 'D', ]
sub_rep <- data_fin[data_fin$'party' == 'R', ]
```

```{r echo=FALSE}
# diff_index distribution for Democrats
gghistogram(sub_dem$diff_index, bins = 7, fill= 'steelblue', xlab = 'Difficulty index', main = 'Difficulty Index: Democrats')
```

```{r echo=FALSE}
# diff_index distribution for Republicans
gghistogram(sub_rep$diff_index, bins = 5, fill= 'steelblue', xlab = 'Difficulty index',  main = 'Difficulty Index: Republicans')

```
### Code: Wilcoxon
#### coding style 1
```{r echo=FALSE}

# is R ranking automatically the values?
#-> yes: same value when calculating:
#   wilcox.test(sort(sub_dem$diff_index), sort(sub_rep$diff_index), alternative = "two.sided", paired = FALSE, conf.int = TRUE)
#   wilcox.test(sub_dem$diff_index, sub_rep$diff_index, alternative = "two.sided", paired = FALSE, conf.int = TRUE)

# alt="two.sided"
# conf.level = ... ? what is the confidence interval we would like?
# do not need and exact p value -> normal approximation of the p value (by default) is used then
# conf.int = TRUE to get : "median of the difference between a sample x and a sample from y"


# what is the wilcox.test argument that differentiate a wilcoxon test under mean hypothesis than wilcoxon test under comparison hypothesis?-> mu=0?

wilcox.test(sub_dem$diff_index, sub_rep$diff_index, mu = 0,  alternative = "two.sided", paired = FALSE, conf.int = TRUE)
```
#### coding style 2
```{r echo=FALSE}
data_fin_reduced <- data_fin %>% select(party, diff_index)
data_fin_reduced <- data_fin_reduced %>% filter(data_fin_reduced$party == 'D' | data_fin_reduced$party == 'R')
```

```{r echo=FALSE}
wilcox.test(diff_index~party,mu = 0,alternative = "two.sided", paired = FALSE, conf.int = TRUE, data = data_fin_reduced )
```

### Code: t-test


```{r echo=FALSE}
# one assumption for the t-test (old version) is: similar variances
# to check if variances from diff_index (democrats) and diff_index (republicans) are similar: use of the F-test
var.test(diff_index~party, data = data_fin_reduced)
```
- ratio of variances different than one.
- lower and upper bounds (from the confidence interval) are higher than 1
-> variances are really different
-> not sure we can use the t-test (old version) then,  nevertheless we can use the Welch's version of the t-test (apparently, default test in R)

```{r echo=FALSE}
t.test(diff_index~party,alternative = "two.sided", paired = FALSE, conf.int = TRUE, data = data_fin_reduced )
```

## Considering diff_subj

### Which test to use?

paired/unpaired?
- we are using two random variables: diff_subj affiliated to Republicans and diff_index associated to Democrats.
- Republicans and Democrats are two different populations
-> unpaired

parametric/non parametric?
- data distrbution is not normal
-> non parametric test

distributions:
-distri of diff_index_rep and diff_index_dem are really similar 

data type?
- diff_subj is binary /not metric
->  Wilcoxon again
->  independent sample t test?

### Hypothesis

null hypothesis of comparisons
H0:P(diff_subj_dem<diff_subj_dem) = P(diff_subj_dem>diff_subj_dem)

### Code Wilcoxon

```{r echo=FALSE}
data_fin_reduced_subj <- data_fin %>% select(party, diff_subj)
data_fin_reduced_subj <- data_fin_reduced_subj %>% filter(data_fin_reduced_subj$party == 'D' | data_fin_reduced_subj$party == 'R')
```

```{r echo=FALSE}
# no mu this time as it is a (2) hypothesis
wilcox.test(diff_subj~party,alternative = "two.sided", paired = FALSE, conf.int = TRUE, data = data_fin_reduced_subj )
```


